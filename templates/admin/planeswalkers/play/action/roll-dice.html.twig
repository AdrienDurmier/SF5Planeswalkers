{% macro script(game, player) %}
    <script>
        let $dice = $('.dice'),
            sides = 20,
            initialSide = 1,
            lastFace,
            timeoutId,
            transitionDuration = 500,
            animationDuration  = 3000

        function randomFace() {
            let face = Math.floor((Math.random() * sides)) + initialSide
            lastFace = face === lastFace ? randomFace() : face
            sendRollDice(lastFace);
            return face;
        }

        function rollTo(face) {
            clearTimeout(timeoutId)
            /*$('ul > li > a').removeClass('active')
            $('[href=' + face + ']').addClass('active')*/
            $dice.attr('data-face', face)
        }

        function reset() {
            $dice.attr('data-face', null).removeClass('rolling')
        }

        $('.dice').click(function () {
            $dice.addClass('rolling')
            clearTimeout(timeoutId)
            timeoutId = setTimeout(function () {
                $dice.removeClass('rolling')
                rollTo(randomFace())
            }, animationDuration)
            return false
        })

        {# Envoie de la face du d√© #}
        function sendRollDice(face){
            let parametres = {
                player: {{ player.id }},
                face: face,
            };
            $.ajax({
                url: "{{ path('planeswalkers.play.action.rolldice.send') }}",
                type: 'post',
                data: parametres,
                dataType: 'json'
            });
        }
    </script>
{% endmacro %}